                          <!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - WhatsApp Bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .message-user { background-color: #dcf8c6; margin-left: 20%; }
        .message-bot { background-color: #ffffff; margin-right: 20%; border: 1px solid #e5e7eb; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-700 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
                <div class="flex items-center space-x-3">
                    <i class="fab fa-whatsapp text-3xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold">WhatsApp Business Bot</h1>
                        <p class="text-blue-100 text-sm">Painel Administrativo Completo</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div id="whatsapp-status" class="flex items-center space-x-2 bg-white/20 rounded-full px-4 py-2">
                        <span id="status-dot" class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></span>
                        <span id="status-text" class="text-sm font-medium">Conectando...</span>
                    </div>
                    <button onclick="location.reload()" class="bg-white/20 hover:bg-white/30 transition-colors px-4 py-2 rounded-lg flex items-center space-x-2">
                        <i class="fas fa-sync-alt"></i>
                        <span>Atualizar</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Stats Dashboard -->
    <div class="container mx-auto px-4 py-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Total Contacts -->
            <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">Total Contatos</p>
                        <p id="total-contacts" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="p-3 bg-blue-100 rounded-lg">
                        <i class="fas fa-users text-blue-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-green-600 text-sm mt-2">
                    <i class="fas fa-arrow-up"></i>
                    <span id="contacts-trend">0</span> este mÃªs
                </p>
            </div>

            <!-- Total Messages -->
            <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">Total Mensagens</p>
                        <p id="total-messages" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="p-3 bg-green-100 rounded-lg">
                        <i class="fas fa-comments text-green-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-green-600 text-sm mt-2">
                    <i class="fas fa-arrow-up"></i>
                    <span id="messages-trend">0</span> hoje
                </p>
            </div>

            <!-- Agendamentos -->
            <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">Agendamentos</p>
                        <p id="total-schedules" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="p-3 bg-purple-100 rounded-lg">
                        <i class="fas fa-calendar text-purple-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-green-600 text-sm mt-2">
                    <i class="fas fa-clock"></i>
                    <span id="schedules-trend">0</span> ativos
                </p>
            </div>

            <!-- Mensagens Hoje -->
            <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">Mensagens Hoje</p>
                        <p id="today-messages" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="p-3 bg-orange-100 rounded-lg">
                        <i class="fas fa-chart-line text-orange-600 text-xl"></i>
                    </div>
                </div>
                <p class="text-green-600 text-sm mt-2">
                    <i class="fas fa-bolt"></i>
                    <span id="today-trend">0</span> em tempo real
                </p>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="bg-white rounded-xl shadow-lg mb-8">
            <div class="border-b border-gray-200">
                <nav class="flex flex-wrap -mb-px">
                    <button data-tab="contacts" class="tab-btn flex items-center space-x-2 py-4 px-6 border-b-2 border-blue-500 text-blue-600 font-medium">
                        <i class="fas fa-users"></i>
                        <span>Contatos</span>
                    </button>
                    <button data-tab="messages" class="tab-btn flex items-center space-x-2 py-4 px-6 text-gray-500 hover:text-blue-500 font-medium">
                        <i class="fas fa-comments"></i>
                        <span>Mensagens</span>
                    </button>
                    <button data-tab="schedule" class="tab-btn flex items-center space-x-2 py-4 px-6 text-gray-500 hover:text-blue-500 font-medium">
                        <i class="fas fa-calendar"></i>
                        <span>Agenda</span>
                    </button>
                    <button data-tab="reports" class="tab-btn flex items-center space-x-2 py-4 px-6 text-gray-500 hover:text-blue-500 font-medium">
                        <i class="fas fa-chart-bar"></i>
                        <span>RelatÃ³rios</span>
                    </button>
                    <button data-tab="templates" class="tab-btn flex items-center space-x-2 py-4 px-6 text-gray-500 hover:text-blue-500 font-medium">
                        <i class="fas fa-palette"></i>
                        <span>Templates</span>
                    </button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div class="p-6">
                <!-- Contacts Tab -->
                <div id="contacts-content" class="tab-content active">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0">
                        <h3 class="text-xl font-semibold text-gray-800">Lista de Contatos</h3>
                        <div class="flex space-x-4">
                            <input type="text" id="search-contacts" placeholder="Buscar contato..." class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <button onclick="exportContacts()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                                <i class="fas fa-download"></i>
                                <span>Exportar</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto bg-white rounded-lg shadow">
                        <table class="min-w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Telefone</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mensagens</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ãšltimo Contato</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">AÃ§Ãµes</th>
                                </tr>
                            </thead>
                            <tbody id="contacts-list" class="bg-white divide-y divide-gray-200">
                                <!-- Contacts will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Messages Tab -->
                <div id="messages-content" class="tab-content">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0">
                        <h3 class="text-xl font-semibold text-gray-800">HistÃ³rico de Mensagens</h3>
                        <select id="contact-select" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Todos os contatos</option>
                        </select>
                    </div>
                    
                    <div id="messages-container" class="bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto">
                        <div id="messages-list" class="space-y-4">
                            <!-- Messages will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Schedule Tab -->
                <div id="schedule-content" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-gray-800">Agendamentos</h3>
                        <button onclick="refreshSchedules()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                            <i class="fas fa-sync-alt"></i>
                            <span>Atualizar</span>
                        </button>
                    </div>
                    
                    <div id="schedules-list" class="grid gap-4">
                        <!-- Schedules will be loaded here -->
                    </div>
                </div>

                <!-- Reports Tab -->
                <div id="reports-content" class="tab-content">
                    <h3 class="text-xl font-semibold text-gray-800 mb-6">RelatÃ³rios e EstatÃ­sticas</h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-4">Atividade Recente</h4>
                            <div id="reports-stats" class="space-y-3">
                                <!-- Stats will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-4">Mensagens por Dia (Ãšltimos 7 dias)</h4>
                            <canvas id="messagesChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Templates Tab -->
                <div id="templates-content" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-gray-800">CatÃ¡logo de Templates</h3>
                        <span class="text-gray-500" id="templates-count">0 templates</span>
                    </div>
                    
                    <div id="templates-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Templates will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentTab = 'contacts';
        let contacts = [];
        let messages = [];
        let schedules = [];
        let templates = [];

        // Tab functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tab = btn.dataset.tab;
                switchTab(tab);
            });
        });

        function switchTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('text-gray-500');
            });
            
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('border-blue-500', 'text-blue-600');
            
            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-content`).classList.add('active');
            
            currentTab = tabName;
            loadTabData(tabName);
        }

        async function loadTabData(tabName) {
            switch(tabName) {
                case 'contacts':
                    await loadContacts();
                    break;
                case 'messages':
                    await loadMessages();
                    break;
                case 'schedule':
                    await loadSchedules();
                    break;
                case 'reports':
                    await loadReports();
                    break;
                case 'templates':
                    await loadTemplates();
                    break;
            }
        }

        // Load functions
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                
                document.getElementById('total-contacts').textContent = stats.totalContacts || 0;
                document.getElementById('total-messages').textContent = stats.totalMessages || 0;
                document.getElementById('total-schedules').textContent = stats.totalSchedules || 0;
                document.getElementById('today-messages').textContent = stats.todayMessages || 0;
                
                // Update trends
                document.getElementById('contacts-trend').textContent = stats.totalContacts || 0;
                document.getElementById('messages-trend').textContent = stats.todayMessages || 0;
                document.getElementById('schedules-trend').textContent = stats.totalSchedules || 0;
                document.getElementById('today-trend').textContent = stats.todayMessages || 0;
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        async function loadWhatsAppStatus() {
            try {
                const response = await fetch('/api/whatsapp-status');
                const status = await response.json();
                
                const dot = document.getElementById('status-dot');
                const text = document.getElementById('status-text');
                
                if (status.connected) {
                    dot.className = 'w-3 h-3 bg-green-500 rounded-full animate-pulse';
                    text.textContent = `Conectado: ${status.phone}`;
                } else {
                    dot.className = 'w-3 h-3 bg-red-500 rounded-full animate-pulse';
                    text.textContent = 'Desconectado';
                }
            } catch (error) {
                console.error('Error loading WhatsApp status:', error);
            }
        }

        async function loadContacts() {
            try {
                const response = await fetch('/api/contacts');
                contacts = await response.json();
                
                const contactsList = document.getElementById('contacts-list');
                contactsList.innerHTML = '';
                
                if (contacts.length === 0) {
                    contactsList.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-6 py-8 text-center text-gray-500">
                                <i class="fas fa-users text-4xl mb-4 text-gray-300"></i>
                                <p>Nenhum contato encontrado</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                contacts.forEach(contact => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors';
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-10 w-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold">
                                    ${contact.name ? contact.name.charAt(0).toUpperCase() : 'C'}
                                </div>
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">${contact.name || 'NÃ£o informado'}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-900">${contact.phone}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                ${contact.message_count || 0}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${new Date(contact.last_contact).toLocaleString('pt-BR')}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="viewMessages('${contact.phone}')" class="text-blue-600 hover:text-blue-900 mr-3">
                                <i class="fas fa-eye"></i> Ver
                            </button>
                        </td>
                    `;
                    contactsList.appendChild(row);
                });
                
                // Update contact select for messages tab
                updateContactSelect();
            } catch (error) {
                console.error('Error loading contacts:', error);
            }
        }

        async function loadMessages(phone = null) {
            try {
                const url = phone ? `/api/messages?phone=${phone}` : '/api/messages';
                const response = await fetch(url);
                messages = await response.json();
                
                const messagesList = document.getElementById('messages-list');
                messagesList.innerHTML = '';
                
                if (messages.length === 0) {
                    messagesList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-comments text-4xl mb-4 text-gray-300"></i>
                            <p>Nenhuma mensagem encontrada</p>
                        </div>
                    `;
                    return;
                }
                
                messages.forEach(message => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `p-4 rounded-lg shadow-sm ${
                        message.sender === 'user' ? 'message-user' : 'message-bot'
                    }`;
                    messageDiv.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-semibold text-sm ${
                                message.sender === 'user' ? 'text-green-700' : 'text-blue-700'
                            }">
                                ${message.sender === 'user' ? 'ðŸ‘¤ ' + (message.name || 'Cliente') : 'ðŸ¤– Bot'}
                            </span>
                            <span class="text-xs text-gray-500">
                                ${new Date(message.timestamp).toLocaleString('pt-BR')}
                            </span>
                        </div>
                        <p class="text-gray-700 whitespace-pre-wrap">${message.message}</p>
                    `;
                    messagesList.appendChild(messageDiv);
                });
                
                // Scroll to bottom
                messagesList.scrollTop = messagesList.scrollHeight;
            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        async function loadSchedules() {
            try {
                const response = await fetch('/api/schedules');
                schedules = await response.json();
                
                const schedulesList = document.getElementById('schedules-list');
                schedulesList.innerHTML = '';
                
                if (schedules.length === 0) {
                    schedulesList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-calendar text-4xl mb-4 text-gray-300"></i>
                            <p>Nenhum agendamento encontrado</p>
                        </div>
                    `;
                    return;
                }
                
                schedules.forEach(schedule => {
                    const scheduleDate = new Date(schedule.schedule_date);
                    const scheduleDiv = document.createElement('div');
                    scheduleDiv.className = 'bg-white border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow';
                    scheduleDiv.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold text-lg text-gray-800">${schedule.name}</h4>
                                <p class="text-gray-600 text-sm">${schedule.phone}</p>
                                <div class="mt-2 flex items-center space-x-4 text-sm">
                                    <span class="flex items-center text-gray-500">
                                        <i class="fas fa-calendar mr-2"></i>
                                        ${scheduleDate.toLocaleDateString('pt-BR')}
                                    </span>
                                    <span class="flex items-center text-blue-600 font-semibold">
                                        <i class="fas fa-clock mr-2"></i>
                                        ${schedule.schedule_time}
                                    </span>
                                </div>
                            </div>
                            <div class="text-right">
                                <span class="px-3 py-1 bg-green-100 text-green-800 text-sm font-medium rounded-full">
                                    ${schedule.status}
                                </span>
                                <p class="text-xs text-gray-500 mt-2">
                                    ${new Date(schedule.created_at).toLocaleString('pt-BR')}
                                </p>
                            </div>
                        </div>
                    `;
                    schedulesList.appendChild(scheduleDiv);
                });
            } catch (error) {
                console.error('Error loading schedules:', error);
            }
        }

        async function loadReports() {
            try {
                const stats = await (await fetch('/api/stats')).json();
                
                const reportsStats = document.getElementById('reports-stats');
                reportsStats.innerHTML = `
                    <div class="flex justify-between items-center py-3 border-b">
                        <span class="text-gray-600">Taxa de resposta:</span>
                        <span class="font-semibold text-green-600">${Math.round((stats.todayMessages / Math.max(stats.totalContacts, 1)) * 100)}%</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b">
                        <span class="text-gray-600">MÃ©dia mensagens/dia:</span>
                        <span class="font-semibold">${Math.round(stats.totalMessages / 30)}</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b">
                        <span class="text-gray-600">Agendamentos ativos:</span>
                        <span class="font-semibold text-blue-600">${stats.totalSchedules}</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b">
                        <span class="text-gray-600">Mensagens esta semana:</span>
                        <span class="font-semibold text-purple-600">${stats.weekMessages || 0}</span>
                    </div>
                `;
                
                // Simple chart
                const ctx = document.getElementById('messagesChart').getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'SÃ¡b', 'Dom'],
                        datasets: [{
                            label: 'Mensagens por Dia',
                            data: [12, 19, 8, 15, 12, 6, 9],
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('Error loading reports:', error);
            }
        }

        async function loadTemplates() {
            try {
                const response = await fetch('/api/templates');
                templates = await response.json();
                
                const templatesList = document.getElementById('templates-list');
                const templatesCount = document.getElementById('templates-count');
                
                templatesCount.textContent = `${templates.length} templates disponÃ­veis`;
                templatesList.innerHTML = '';
                
                templates.forEach(template => {
                    const templateDiv = document.createElement('div');
                    templateDiv.className = 'bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow';
                    templateDiv.innerHTML = `
                        <div class="p-4 border-b">
                            <h4 class="font-semibold text-lg text-gray-800">${template.name}</h4>
                            <p class="text-gray-600 text-sm mt-1">${template.description}</p>
                        </div>
                        <div class="p-4">
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-2xl font-bold text-green-600">R$ ${template.price}</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded">${template.category}</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-3">
                                <i class="fas fa-clock mr-1"></i>Entrega: ${template.delivery}
                            </div>
                            <div class="text-xs text-gray-500">
                                ${template.features.slice(0, 3).map(f => `âœ… ${f}`).join('<br>')}
                            </div>
                        </div>
                    `;
                    templatesList.appendChild(templateDiv);
                });
            } catch (error) {
                console.error('Error loading templates:', error);
            }
        }

        // Utility functions
        function updateContactSelect() {
            const contactSelect = document.getElementById('contact-select');
            contactSelect.innerHTML = '<option value="">Todos os contatos</option>';
            
            contacts.forEach(contact => {
                const option = document.createElement('option');
                option.value = contact.phone;
                option.textContent = `${contact.name || 'Cliente'} - ${contact.phone}`;
                contactSelect.appendChild(option);
            });
        }

        function viewMessages(phone) {
            switchTab('messages');
            document.getElementById('contact-select').value = phone;
            loadMessages(phone);
        }

        function refreshSchedules() {
            loadSchedules();
            showNotification('Agenda atualizada!', 'success');
        }

        function exportContacts() {
            const data = JSON.stringify(contacts, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `contatos-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('Contatos exportados com sucesso!', 'success');
        }

        function showNotification(message, type = 'info') {
            // Simple notification implementation
            alert(`${type.toUpperCase()}: ${message}`);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load initial data
            loadStats();
            loadWhatsAppStatus();
            loadContacts();
            
            // Set up event listeners
            document.getElementById('contact-select').addEventListener('change', (e) => {
                loadMessages(e.target.value || null);
            });
            
            document.getElementById('search-contacts').addEventListener('input', (e) => {
                // Implement search functionality
                const searchTerm = e.target.value.toLowerCase();
                // Filter logic would go here
            });
            
            // Auto-refresh data every 30 seconds
            setInterval(() => {
                loadStats();
                loadWhatsAppStatus();
                
                if (currentTab === 'contacts') loadContacts();
                else if (currentTab === 'messages') loadMessages();
                else if (currentTab === 'schedule') loadSchedules();
            }, 30000);
        });
    </script>
</body>
    </html>
